var Model=function(e,f){var d=function(a){this._name=e;this.attributes=a||{};this.changes={};this.errors=[];$().trigger(this._name+":initialize",[this])};d.prototype=$.extend({attr:function(a,b){if(arguments.length==2){if(_.isEqual(this.attributes[a],b))delete this.changes[a];else this.changes[a]=b;return this}else{var c=this.changes[a];return c==undefined?this.attributes[a]:c}},changed:function(){$().trigger(this._name+":changed",[this]);return this},clearChanges:function(){this.changes={};return this},
destroy:function(){$().trigger(this._name+":destroy",[this]);return this},id:function(){return this.attributes.id||null},newRecord:function(){return this.id()==null},save:function(){if(!this.valid())return false;this.attributes=$.extend(this.attributes,this.changes);this.clearChanges();$().trigger(this._name+":save",[this]);return true},toParam:function(){var a={};for(var b in this.attributes){var c=this.attributes[b];if(b!="id"&&c!=null)a[this._name+"["+b+"]"]=c}return a},valid:function(){return this.validate().errors.length==
0},validate:function(){this.errors=[];return this}},f);return d};
